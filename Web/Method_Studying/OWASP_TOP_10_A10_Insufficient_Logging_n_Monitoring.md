#Mentoring_Web #OWASP_TOP_10

Insufficient Logging & Monitoring이다. 이것도 개발자의 부주의로 발생하게 될 것 같다. 이러한 것들은 사고에 대해 반응이 없어지거나 비효율적으로 되게 되고, 공격자들의 추가적인 시스템 공격으로 이어지며, 계속 이어지게 된다면 더 많은 시스템이 위험해지고, 데이터의 훼손, 오염으로 이어질 수 있다. 대부분의 위반에 대한 연구들은 내부 과정이나 모니터링이 아닌 외부 단체에 대해 공격을 조사하면 200일 이상의 시간이 걸린다는 것을 알 수 있다.

우선 공격 가능성은 2점이다. 이러한 불충분한 기록과 감시에 대한 공격은 대부분의 사고의 기틀이 된다. 공격자들은 모니터링의 부족과 늦어지는 대응으로 그들의 목표를 성공해낸다.

존재가능성은 3점이고, 발견 가능성은 1점이다. 이 문제도 업계 설문조사 결과로 포함된 문제다. 충분한 모니터링이 되고 있는지 확인하는 방법은 penetration testing을 해 로그를 관찰한느 것이다. 테스터의 행동이 충분히 기록되어야 그들이 끼치고자 한 피해를 충분히 알 수 있다.

기술적 영향은 2점이다. 성공한 공격들 대부분은 취약점 관찰로부터 시작되는데, 이러한 관찰을 계속 하도록 한다면 익스플로잇의 성공 확률을 엄청나게 높일 수 있다. 2016년에 조사 결과는 이러한 공격을 찾아내는데 평균적으로 191일이 걸렸다는 것을 알 수 ㅣㅇㅆ고, 이는 공격에 충분한 시간이다.

충분하지 않은 기록, 감지, 모니터링과 액티브 리스폰스는 항상 일어날 수 있다. 다음과 같은 상황에서 취약할 수 있다.

-- 로그인과 실패한 로그인, 높은 가치의 거래 등의 기록되어야 할 기록들이 기록되지 않을 때

-- 에러 메시지가 충분치 못하거나 명확하지 않은 로그를 기록하거나, 아예 기록하지 않을 때

-- 어플리케이션과 APi의 로그에서 의심스러운 활동이 기록되지 않을 때

-- 로그가 로컬에만 저장될 때

-- 적절한 임계점에 대한 알림과 대응 과정이 없거나 효율적이지 못할 때

-- 침투 시험과 DAST 툴로 시행한 시험에서 알림이 울리지 않을 떄

-- 어플리케이션이 공격을 실시간으로 감지하거나 반응하지 않을 때

데이터가 저장되고 처리되는 과정에서 리스크를 줄이려면 다음과 같은 방법을 사용하자

-- 모든 로그인, 접근 관리 오류, 서버단 입력 검증 실패들이 다 로그에 유저에게 충분하기 기록되도록 하자. 그리고 포렌식 분석 지연에 충분한 시간을 잡자.

-- 중앙화 처리된 로그 관리 솔루션으로 읽기 좋게 로그가 생성되는지 확인하자.

-- 높은 가치의 거래가 탬퍼링이나 딜리션을 막기 위한 통합된 컨트롤이 포함된 auit trail을 가지고 있는지 확인하자, 예룰 들면 데이터 추가만 가능한 데이터베이스 테이블 등.

-- 의심되는 행동을 감지하는 효율적인 모니터링 / 알람을 구성하자.

-- 즉각적인 반응과 복구 계획을 설립하거나 채택하자.

공격 예시는 다음과 같다.

-- 오픈 소스 프로젝트 포럼의 소프트웨어가 작은 팀에 사용되었는데 이 프로그램의 취약점으로 공격이 이루어졌다. 공격자는 다음 버전이 포함된 내부 소스코드 리포지터리를 날렸고, 모든 포럼 컨텐츠를 날렸다. 소스는 복원 될 수 있어도, 모니터링이 부족하고, 로그와 얼럿이 훼손 되어 이 포럼 소프트웨어는 사용 불가능하게 되었다.

-- 공격자는 유저에게 일반적인 비밀번호로 스캐닝을 한다. 그들은 알려진 비밀번호로 계정을 탈취한다. 모든 유저에게 이 스캔은 한번의 실패한 로그인만 남긴다. 이러한 상황은 조금 지나 다른 비밀번호로 다시 시행될 수 있다.

-- 미국의 메이저 소매상이 첨부파일을 분석해 내부 멀웨어가 있었다는 사실을 알아냈다. 샌드박스 소프트웨어가 위험한 소프트웨어를 발견했지만, 아무도 대처하지 않았다. 샌드박스는 외부 은행으로 카드 사기 거래가 날때가지 알림을 보냈다.

이게 시간이 지날수록 퀄이 개작살이 나는데 어쩔수가 없다, 너무 힘들다. 여튼 취약점 자체는 여기까진데, 맘같아선 문서 다 읽고싶지만, 시간을 이상한데 꼬라박았더니 삶이 꼬여버려서 일단은 보류.